import { sign } from 'jsonwebtoken'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function main() {
  // RÃ©cupÃ©rer l'utilisateur existant
  const user = await prisma.user.findFirst()
  
  if (!user) {
    console.error('Aucun utilisateur trouvÃ©')
    return
  }

  console.log(`ðŸ‘¤ Utilisateur: ${user.email}`)
  console.log(`ðŸ†” ID: ${user.id}`)

  // GÃ©nÃ©rer un token JWT valide
  const token = sign(
    { 
      userId: user.id, 
      email: user.email 
    },
    process.env.NEXTAUTH_SECRET || 'fallback-secret',
    { expiresIn: '7d' }
  )

  console.log('\nðŸ”‘ Token JWT gÃ©nÃ©rÃ©:')
  console.log(token)
  
  console.log('\nðŸ“‹ Utilisation:')
  console.log(`Cookie: auth-token=${token}`)
}

main()
  .catch(console.error)
  .finally(() => prisma.$disconnect())
